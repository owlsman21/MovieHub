<!DOCTYPE html>
<html lang="en">
<head>
       <script async src="https://www.googletagmanager.com/gtag/js?id=G-KS61BKE3Y2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-KS61BKE3Y2'); // Your Measurement ID
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Members Movies</title>
    <link rel="stylesheet" href="css/main.css">
    <script>
        // Check if the user is considered logged in based on localStorage
        // This 'isLoggedIn' variable is local to this script block.
        const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';

        // If not logged in, redirect immediately to the login page
        if (!isLoggedIn) {
            window.location.href = 'login.html';
        }
    </script>
</head>
<body>
    <div id="members-content">
        <div class="container">
            <div class="header">
                <h1>Exclusive Member Movies</h1>
                <div class="nav-buttons">
                    <button onclick="window.location.href='movies.html'">All Public Movies</button>
                    <button onclick="logout()">Logout</button>
                </div>
            </div>

            <div class="movie-grid" id="memberMoviesContainer">
            </div>
        </div>
    </div>

    <script>
        // --- IMPORTANT: This `isLoggedIn` variable is now controlled by the <head> script. ---
        // Do NOT redeclare `isLoggedIn` here.

        const memberMoviesData = [
            {
                "id": "Cowboys-And-Aliens",
                "posterUrl": "images/Cowboys & Aliens.jpg",
                "year": 2011,
                "title": "Cowboys & Aliens",
                "description": "FROM THE DIRECTOR OF IRON MAN",
                "source": "ok.ru",
                "embedId": "37439867626",
                "genres": ["Western", "Sci-Fi", "Action"]
            },
            {
                "id": "Avatar",
                "posterUrl": "images/Avatar.jpg",
                "year": 2009,
                "title": "Avatar",
                "description": "A paraplegic Marine dispatched to the moon Pandora on a unique mission becomes torn between following his orders and protecting the world he feels is his home.",
                "source": "mega",
                "embedId": "n8wzFCyL#fFtowWI_qo1Meskf8vwASCajksUe0p7n1rxHelrWfzU",
                "genres": ["Sci-Fi", "Adventure"]
            },
            {
                "id": "Avatar-The-Way-of-Water",
                "posterUrl": "images/Avatar The Way of Water.jpg",
                "year": 2022,
                "title": "Avatar The Way of Water",
                "description": "",
                "source": "mega",
                "embedId": "XoJEhAIS#DIFG6YM4o5Q8lAjH_DgLfxKntZJQRF1lLYq4g_WEj1g",
                "genres": ["Sci-Fi", "Drama","Action"]
            },
            {
                "id": "Kandahar",
                "posterUrl": "images/Kandahar.jpg",
                "year": 2023,
                "title": "Kandahar",
                "description": "A CIA operative and his translator flee from special forces in Afghanistan after exposing a covert mission.",
                "source": "mega",
                "embedId": "XoJEhAIS#DIFG6YM4o5Q8lAjH_DgLfxKntZJQRF1lLYq4g_WEj1g",
                "genres": ["Thriller", "Drama","Action"]
            },
             {
                "id": "Greyhound",
                "posterUrl": "images/Greyhound.jpg",
                "year": 2020,
                "title": "Greyhound",
                "description": "Several months after the U.S. entry into World War II, an inexperienced U.S. Navy commander must lead an Allied convoy being stalked by a German submarine wolf pack.",
                "source": "mega",
                "embedId": "S0BHmDoS#QLZpkLp9S3C1uI6A28X67VQeu2kiMxIqg",
                "genres": ["War","Action","Drama"]
            },
             {
                "id": "Gunslingers ",
                "posterUrl": "images/Gunslingers.jpg",
                "year": 2025,
                "title": "Gunslingers ",
                "description": "In a town named Redemption, reformed gunslinger Keller and mad genius Ben are guided by spiritual leader Jericho towards vindication. While confronting their violent histories, their newfound peace is challenged by violence and revenge.",
                "source": "mega",
                "embedId": "Skp0ySJR#Xd2QczBoQzKkBoqR-CoQTfaHOGEMAAZh",
                "genres": ["Western"]
            },
             {
                "id": "In-the-Name-of-the-Father",
                "posterUrl": "images/In the Name of the Father.jpg",
                "year": 1993,
                "title": "In the Name of the Father",
                "description": "An Irish man's coerced confession to an I.R.A. bombing he did not commit results in the imprisonment of his father as well. Meanwhile, a British lawyer fights to clear their names and free them.",
                "source": "mega",
                "embedId": "r9Qx0AIA#HrsgjODNqFWeJcrO7Hoa4mUFuF9CBpBZpgeHG8UkoH8",
                "genres": ["Drama","Crime"]
            },
             {
                "id": "Avengers-Infinity-War",
                "posterUrl": "images/Avengers Infinity War.jpg",
                "year": 2018,
                "title": "Avengers Infinity War",
                "description": "The Avengers and their allies must be willing to sacrifice all in an attempt to defeat the powerful Thanos before his blitz of devastation and ruin puts an end to the universe.",
                "source": "mega",
                "embedId": "mhpA0KgT#6-6OpWyfnEs4wSdFf373SzTTPQCnHkeHQ4k4crNoNjg",
                "genres": ["Sci-Fi","Action","Adventure"]
            },
             {
                "id": "Avengers-Endgame",
                "posterUrl": "images/Avengers Endgame.jpg",
                "year": 2019,
                "title": "Avengers Endgame",
                "description": "After the devastating events of Avengers: Infinity War (2018), the universe is in ruins. With the help of remaining allies, the Avengers assemble once more in order to reverse Thanos' actions and restore balance to the universe.",
                "source": "mega",
                "embedId": "20JQjAQS#uBQARa1pRlpIu9nIiIFx1BaPzzeWGkUABPXRurVUZ_A",
                "genres": ["Sci-Fi","Action","Adventure"]
            },
             {
                "id": "No-Country-for-Old-Men",
                "posterUrl": "images/No Country for Old Men.jpg",
                "year": 2007,
                "title": "No Country for Old Men",
                "description": "Violence and mayhem ensue after a hunter stumbles upon the aftermath of a drug deal gone wrong and over two million dollars in cash near the Rio Grande.",
                "source": "mega",
                "embedId": "L9pSzIbR#3thvARLRYZfMFSxovOYXjqZ2t77T9slVbnRhm1eUGDk",
                "genres": ["Action","Crime","Thriller","Drama"]
            },
             {
                "id": "Rise-of-the-Planet-of-the-Apes",
                "posterUrl": "images/Rise of the Planet of the Apes.jpg",
                "year": 2014,
                "title": "Rise of the Planet of the Apes",
                "description": "A substance designed to help the brain repair itself gives advanced intelligence to a chimpanzee who leads an ape uprising.",
                "embedId": "DEcGzAKC#vEA5-cAQ-p7Clki40tc2ELWG2TIY5p5J9R3ZZvrbYfs",
                "genres": ["Sci-Fi","Action","Drama","Thriller"]
            },
            {
                "id": "Open-Range",
                "posterUrl": "images/Open Range.jpg",
                "year": 2003,
                "title": "Open Range",
                "description": "A former gunslinger is forced to take up arms again when he and his cattle crew are threatened by a corrupt landowner",
                "source": "mega",
                "embedId": "uZNF0LTC#zRcoYDhzxVnvxJtu5nFt4LkSM82UZGwJAHA27OpMIwg",
                "genres": ["Western"]
            },
            {
                "id": "Danger-Close",
                "posterUrl": "images/Danger Close.jpg",
                "year": 2019,
                "title": "Danger Close",
                "description": "In August 1966, in a Vietnamese rubber plantation called Long Tan, 108 young and inexperienced Australian and New Zealand soldiers are fighting for their lives against 2500 North Vietnamese and Viet Cong soldiers.",
                "source": "mega",
                "embedId": "3YUEnayT#TgpHBAMSbZaqXhKcoyoFrC6qdJCKG__Mg4CaBGkOo2g",
                "genres": ["War","Action"]
            },
            {
                "id": "Dead-Mans-Shoes",
                "posterUrl": "images/Dead Mans Shoes.jpg",
                "year": 2004,
                "title": "Dead Mans Shoes",
                "description": "A disaffected soldier returns to his hometown to get even with the thugs who brutalized his mentally-challenged brother years ago.",
                "source": "mega",
                "embedId": "ucshCKLJ#TteUTukfc1lm5CjmEAfDMFYQPo1R0dG1SWa_kSrobcY",
                "genres": ["Drama","Action","Thriller","Crime"]
            },
             {
                "id": "Evil Dead Rise",
                "posterUrl": "images/Evil Dead Rise.jpg",
                "year": 2023,
                "title": "Evil Dead Rise",
                "description": "A twisted tale of two estranged sisters whose reunion is cut short by the rise of flesh-possessing demons, thrusting them into a primal battle for survival as they face the most nightmarish version of family imaginable.",
                "source": "mega",
                "embedId": "SBE02Ibb#dXonKtnSl-v4QXu5jfamqwSxHJqPqrDlW6gHf590at4",
                "genres": ["Horror"]
            },
             {
                "id": "Interstellar",
                "posterUrl": "images/Interstellar.jpg",
                "year": 2014,
                "title": "Interstellar",
                "description": "When Earth becomes uninhabitable in the future, a farmer and ex-NASA pilot, Joseph Cooper, is tasked to pilot a spacecraft, along with a team of researchers, to find a new planet for humans.",
                "source": "mega",
                "embedId": "3Rklza4Y#ZBCXStBP3MelqAUgfRwvnM8xpn1jg9hmU3N6eLKlQ4M",
                "genres": ["Sci-Fi","Drama","Adventure"]
            },
             {
                "id": "Alien-Romulus",
                "posterUrl":  "images/Alien Romulus.jpg",
                "year":2025,
                "title": "Alien Romulus",
               "description": "While scavenging the deep ends of a derelict space station, a group of young space colonists come face to face with the most terrifying life form in the universe.",
               "embedId": "PA1SnTjA#pMGm2_WGH8DncpqMLnw0_AcINcUlDJl9YraX3kLj_bM",
               "genres": ["Horror","Sci-Fi","Thriller"],
               "source": "mega"
            },
             {
               "id": "Nosferatu",
               "posterUrl":  "images/Nosferatu.jpg",
               "year":2024,
               "title": "Nosferatu",
               "description": "A gothic tale of obsession between a haunted young woman and the terrifying vampire infatuated with her, causing untold horror in its wake.",
               "embedId": "uMdBCQoA#-KUDhqEdX-j3ckfYyn5XsUg2uMOqTosSUq9_EVau7S0",
               "genres": ["Horror","Mystery"],
               "source": "mega"
           },
           {
               "id": "Karate-Kid-Legends",
               "posterUrl":  "images/Karate Kid Legends.jpg",
               "year":2025,
               "title": "Karate Kid Legends",
               "description": "After kung fu prodigy Li Fong relocates to New York City, he attracts unwanted attention from a local karate champion and embarks on a journey to enter the ultimate karate competition with the help of Mr. Han and Daniel LaRusso.",
               "embedId": "vMlhHJzD#ho3RSbyQcR7q2bjHMAK0YehkZiluTlVMB8y3x0sz9S0",
               "genres": ["Drama","Action"],
              "source": "mega"
            },
             {
                "id": "",
                "posterUrl": "images/.jpg",
                "year": 2023,
                "title": "",
                "description": "",
                "source": "mega",
                "embedId": "",
                "genres": [""]
            },
             {
                "id": "",
                "posterUrl": "images/.jpg",
                "year": 2023,
                "title": "",
                "description": "",
                "source": "mega",
                "embedId": "",
                "genres": [""]
            },
             {
                "id": "",
                "posterUrl": "images/.jpg",
                "year": 2023,
                "title": "",
                "description": "",
                "source": "mega",
                "embedId": "",
                "genres": [""]
            },
        ];

        function renderMovies(movies, containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;

            container.innerHTML = ''; // Clear existing content before rendering

            movies.forEach(movie => {
                const movieItem = document.createElement('div');
                movieItem.classList.add('movie-card'); // Changed from 'movie-item' to 'movie-card'

                const posterSrc = movie.posterUrl ? movie.posterUrl : 'images/placeholder.jpg';

                movieItem.innerHTML = `
                    <img src="${posterSrc}" alt="${movie.title} Poster">
                    <h3>${movie.title}</h3>
                    <p>${movie.year} | ${movie.genres.join(', ')}</p>
                    <button onclick="viewMovie('${movie.id}', '${movie.source}', '${movie.embedId}')">View Movie</button>
                `;
                container.appendChild(movieItem);
            });
        }

        function viewMovie(movieId, movieSource, movieEmbedId) {
            const clickedButton = document.querySelector(`[onclick*="viewMovie('${movieId}'"]`);
            if (!clickedButton) {
                console.error("Could not find the clicked button for movie ID:", movieId);
                return;
            }
            const movieItem = clickedButton.closest('.movie-card');
            if (!movieItem) {
                console.error("Could not find the movie item for movie ID:", movieId);
                return;
            }

            let embedHtml = '';
            if (movieSource === 'youtube') {
                embedHtml = `<iframe width="100%" height="300" src="http://googleusercontent.com/youtube.com/embed/${movieEmbedId}?autoplay=1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
            } else if (movieSource === 'vimeo') {
                embedHtml = `<iframe width="100%" height="300" src="https://player.vimeo.com/video/${movieEmbedId}?autoplay=1" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>`;
            } else if (movieSource === 'mega') {
                embedHtml = `<iframe width="100%" height="300" frameborder="0" src="https://mega.nz/embed/${movieEmbedId}?autoplay=1" allowfullscreen></iframe>`;
            } else if (movieSource === 'ok.ru') {
                embedHtml = `<iframe width="100%" height="300" src="https://ok.ru/videoembed/${movieEmbedId}?autoplay=1" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>`;
            } else {
                alert('Video source not supported.');
                return;
            }

            const originalMovieData = memberMoviesData.find(m => m.id === movieId);
            if (!originalMovieData) {
                console.error("Original movie data not found for ID:", movieId);
                return;
            }

            movieItem.dataset.originalContent = movieItem.innerHTML;

            movieItem.innerHTML = `
                <div class="movie-card-media">
                    ${embedHtml}
                </div>
                <h3>${originalMovieData.title}</h3>
                <p>Playing Now...</p>
                <button onclick="restoreMovieCard('${movieId}')">Back to Movies</button>
            `;
        }

        function restoreMovieCard(movieId) {
            const movieItem = document.querySelector(`[onclick*="restoreMovieCard('${movieId}'"]`).closest('.movie-card');
            if (movieItem && movieItem.dataset.originalContent) {
                movieItem.innerHTML = movieItem.dataset.originalContent;
                delete movieItem.dataset.originalContent;
            } else {
                renderMovies(memberMoviesData, 'memberMoviesContainer');
            }
        }

        function logout() {
            alert('You have been logged out.');
            localStorage.setItem('isLoggedIn', 'false'); // Clear login state in localStorage
            window.location.href = 'index.html'; // Redirect to home page
        }

        // Initial rendering when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            // This 'isLoggedIn' refers to the one declared in the <head> script.
            // It will be true ONLY if localStorage.getItem('isLoggedIn') was 'true'.
            if (isLoggedIn) {
                renderMovies(memberMoviesData, 'memberMoviesContainer');
            } else {
                // If not logged in, show access denied message
                const contentDiv = document.getElementById('members-content');
                if (contentDiv) {
                    contentDiv.innerHTML = `
                        <div id="access-denied">
                            <h2>Access Denied</h2>
                            <p>You must be logged in to view exclusive member movies.</p>
                            <p><a href="login.html">Login Here</a></p>
                        </div>
                    `;
                }
            }
        });
    </script>
</body>
</html>