<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Details - The Movie Hub</title>

    <!-- Open Graph / SEO base (will be updated by JS) -->
    <meta property="og:type" content="video.movie">
    <meta property="og:url" id="ogUrl" content="https://moviehub.zya.me/movie-detail.html">
    <meta property="og:title" id="ogTitle" content="The Movie Hub">
    <meta property="og:description" id="ogDescription" content="Your ultimate destination for discovering and watching classic films.">
    <meta property="og:image" id="ogImage" content="https://moviehub.zya.me/images/Facebook.png">
    <meta property="og:image:width" content="940">
    <meta property="og:image:height" content="788">
    <meta name="description" id="metaDescription" content="Watch classic movies online at The Movie Hub.">

    <link rel="stylesheet" href="css/style.css">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KS61BKE3Y2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-KS61BKE3Y2');
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');

        body {
            font-family: 'Inter', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #1a1a2e;
            color: #e0e0e0;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* ── Enhanced Video Player ─────────────────────────────── */
        .video-player {
            position: relative;
            width: 100%;
            max-width: 1080px;
            margin: 2.5rem auto;
            aspect-ratio: 16 / 9;
            background: #000;
            overflow: hidden;
            border-radius: 12px;
            box-shadow: 
                0 10px 40px rgba(0,0,0,0.7),
                0 0 0 1px rgba(93,63,211,0.25);
            transition: all 0.35s ease;
        }

        .video-player:hover {
            transform: translateY(-8px);
            box-shadow: 
                0 25px 70px rgba(0,0,0,0.8),
                0 0 0 2px rgba(93,63,211,0.4);
        }

        .video-player iframe,
        .video-player img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            object-fit: cover;
        }

        @media (min-width: 1400px) {
            .video-player {
                max-width: 1280px;
            }
        }

        .video-hint {
            text-align: center;
            color: #bbb;
            font-size: 0.95rem;
            margin: 1rem 0 2.5rem;
            font-style: italic;
        }

        .movie-detail-content {
            padding: 2rem 0;
        }

        .movie-detail-info {
            margin: 2.5rem 0;
            background: rgba(20, 20, 40, 0.65); /* darker & more opaque for contrast */
            padding: 1.8rem;
            border-radius: 10px;
            border: 1px solid #444;
            color: #f1f5f9; /* lighter text */
        }

        .movie-detail-info strong {
            color: #ffffff;
        }

        .movie-detail-info p {
            margin: 1rem 0;
            font-size: 1.05rem;
        }

        h2 {
            color: #FFC300;
            margin-bottom: 1.5rem;
            font-size: 2.4rem;
        }

        /* ── Share Buttons ─────────────────────────────── */
        .share-buttons-container {
            margin: 3rem 0 2rem;
            text-align: center;
        }

        .share-button {
            display: inline-block;
            margin: 0 1rem;
            padding: 0.8rem 1.6rem;
            font-weight: 600;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.25s ease;
            font-size: 1.05rem;
        }

        .share-button {
            background: rgba(34, 211, 238, 0.12); /* subtle cyan bg */
            color: #22d3ee; /* bright readable cyan */
            border: 1px solid #22d3ee;
        }

        .share-button:hover,
        .share-button:focus {
            background: #22d3ee;
            color: #0f172a;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(34, 211, 238, 0.35);
        }

        .share-button.twitter { /* optional slight color variation if you want */
            /* border-color: #1da1f2; color: #1da1f2; */
        }
    </style>
</head>
<body>

<header class="bg-[#0d0d0d] border-b-4 border-[#5D3FD3] p-5">
    <div class="container mx-auto flex flex-col md:flex-row justify-between items-center">
        <h1 class="bebas text-4xl text-[#FFC300] tracking-wider uppercase font-bold">THE MOVIE HUB</h1>
        <nav>
            <ul class="flex flex-wrap gap-4 justify-center md:justify-end mt-4 md:mt-0 font-bold items-center">
                <li><a href="index.html" class="text-white hover:text-red-500 transition">Home</a></li>
                <li><a href="movies.html" class="text-white hover:text-red-500 transition">Movies</a></li>
                <li><a href="western.html" class="text-[#FFC300] hover:text-white transition">Westerns</a></li>
                <li><a href="motd.html" class="text-red-500 hover:text-yellow-400 transition">Movie Of The Week</a></li>
                <li><a href="about.html" class="text-white hover:text-red-500 transition">About</a></li>
                <li><a href="contact-us.html" class="text-white hover:text-red-500 transition">Contact</a></li>
                <li><a href="blog/index.html" class="text-white hover:text-red-500 transition">Blog</a></li>
            </ul>
        </nav>
    </div>
</header>

<main>
    <section id="movie-detail-section" class="section-padded">
        <div class="container movie-detail-content">
            <h2 id="movieTitle">Loading Movie...</h2>

            <div class="video-player" id="videoPlayerContainer">
                <!-- iframe or fallback image inserted by JS -->
            </div>

            <div class="video-hint">For the best experience — use fullscreen (double-click or F key)</div>

            <div class="movie-detail-info">
                <p><strong>Description:</strong> <span id="movieDescription"></span></p>
                <p><strong>Genres:</strong> <span id="movieGenres"></span></p>
                <p><strong>Release Date:</strong> <span id="movieReleaseDate"></span></p>
                <p><strong>Year:</strong> <span id="movieYear"></span></p>
                <p><strong>Source:</strong> <span id="movieSource"></span></p>
                <p><strong>Views:</strong> <span id="movieViews">0</span></p>
            </div>

            <!-- Rumble subscribe CTA -->
            <div style="margin: 40px 0; text-align: center; border-top: 1px solid #444; padding-top: 25px;">
                <p style="color: #FFC300; font-weight: bold; margin-bottom: 12px; font-family: sans-serif;">Support the Channel:</p>
                <a href="https://rumble.com/c/ActionCinemaHub" target="_blank" 
                   style="background-color: #85c742; color: white; padding: 14px 28px; text-decoration: none; font-family: Arial, sans-serif; font-weight: bold; border-radius: 5px; display: inline-block; transition: 0.3s; box-shadow: 0 4px 6px rgba(0,0,0,0.3);">
                    <img src="https://rumble.com/s/v1/img/favicon.png" alt="Rumble" style="width: 20px; vertical-align: middle; margin-right: 10px;">
                    SUBSCRIBE ON RUMBLE
                </a>
            </div>

            <!-- Recommended movies -->
            <section class="recommended-section" style="padding: 40px 20px; background-color: #1a1a1a; border-top: 2px solid #5D3FD3;">
                <div class="container mx-auto">
                    <h3 class="bebas text-[#FFC300] text-3xl mb-6">You Might Also Like</h3>
                    <div id="recommended-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6"></div>
                </div>
            </section>

            <!-- Share buttons (updated styling via CSS above) -->
            <div class="share-buttons-container">
                <a id="facebookShareBtn" class="share-button" target="_blank" rel="noopener noreferrer">
                    Share on Facebook
                </a>
                <a id="twitterShareBtn" class="share-button" target="_blank" rel="noopener noreferrer">
                    Share on Twitter
                </a>
                <a id="whatsappShareBtn" class="share-button" target="_blank" rel="noopener noreferrer">
                    Share on WhatsApp
                </a>
            </div>
        </div>
    </section>
</main>

<footer>
    <div class="container">
        <p>© 2025 The Movie Hub. All rights reserved.</p>
        <p><a href="#">Privacy Policy</a> | <a href="#">Terms of Service</a></p>
    </div>
</footer>

<script>
// MOVIE DATA FROM movies.json — unchanged

let moviesData = [];

function getEmbedUrl(movie) {
    if (!movie?.embedId) return null;

    switch (movie.source?.toLowerCase()) {
        case "rumble":   return `https://rumble.com/embed/${movie.embedId}/?pub=4`;
        case "ok.ru":    return `https://ok.ru/videoembed/${movie.embedId}`;
        case "youtube":  return `https://www.youtube.com/embed/${movie.embedId}?modestbranding=1&rel=0`;
        default:         return null;
    }
}

function loadRecommendedMovies(currentId) {
    const grid = document.getElementById('recommended-grid');
    if (!grid || !moviesData.length) return;

    const others = moviesData.filter(m => m.id !== currentId);
    const shuffled = others.sort(() => 0.5 - Math.random());
    const selected = shuffled.slice(0, 4);

    grid.innerHTML = selected.map(m => `
        <a href="movie-detail.html?id=${m.id}" class="recommended-card">
            <img src="${m.posterUrl || 'https://placehold.co/300x200/222/FFC300?text=' + encodeURIComponent(m.title)}" 
                 alt="${m.title}" loading="lazy">
            <h4>${m.title} (${m.year || 'N/A'})</h4>
        </a>
    `).join('');
}

document.addEventListener('DOMContentLoaded', async () => {
    const params = new URLSearchParams(window.location.search);
    const movieId = params.get('id');

    if (!movieId) {
        document.getElementById('movieTitle').textContent = "No movie selected";
        return;
    }

    try {
        const res = await fetch('movies.json');
        if (!res.ok) throw new Error("Could not load movies.json");
        moviesData = await res.json();

        const movie = moviesData.find(m => m.id === movieId);
        if (!movie) {
            document.getElementById('movieTitle').textContent = "Movie Not Found";
            document.getElementById('videoPlayerContainer').innerHTML = "<p>Sorry, this movie is not available.</p>";
            return;
        }

        document.getElementById('movieTitle').textContent       = movie.title || "Untitled";
        document.getElementById('movieDescription').textContent = movie.description || "No description available.";
        document.getElementById('movieGenres').textContent      = movie.genres?.join(', ') || "N/A";
        document.getElementById('movieReleaseDate').textContent = movie.release_date || movie.year || "N/A";
        document.getElementById('movieYear').textContent        = movie.year || "N/A";
        document.getElementById('movieSource').textContent      = movie.source || "Unknown";

        let views = Number(localStorage.getItem(`views_${movieId}`) || movie.views || 0);
        views += 1;
        localStorage.setItem(`views_${movieId}`, views);
        document.getElementById('movieViews').textContent = views;

        const container = document.getElementById('videoPlayerContainer');
        container.innerHTML = '';
        const embedUrl = getEmbedUrl(movie);

        if (embedUrl) {
            const iframe = document.createElement('iframe');
            iframe.src = embedUrl;
            iframe.allowFullscreen = true;
            iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen";
            iframe.frameBorder = "0";
            container.appendChild(iframe);
        } else {
            const img = document.createElement('img');
            img.src = movie.posterUrl || 'images/placeholder.jpg';
            img.alt = movie.title;
            img.style.maxWidth = "100%";
            container.appendChild(img);
        }

        document.title = `${movie.title} - Watch Online | The Movie Hub`;
        document.getElementById('metaDescription')?.setAttribute("content", `Watch ${movie.title} and other classic films online at The Movie Hub.`);
        document.getElementById('ogTitle')?.setAttribute("content", `${movie.title} - The Movie Hub`);
        document.getElementById('ogImage')?.setAttribute("content", movie.posterUrl || "https://moviehub.zya.me/images/Facebook.png");

        const schema = {
            "@context": "https://schema.org",
            "@type": "VideoObject",
            "name": movie.title,
            "description": movie.description || "Classic film available at The Movie Hub",
            "thumbnailUrl": movie.posterUrl || "",
            "uploadDate": movie.release_date || "2025-01-01",
            "embedUrl": embedUrl || ""
        };
        const script = document.createElement('script');
        script.type = "application/ld+json";
        script.text = JSON.stringify(schema);
        document.head.appendChild(script);

        const pageUrl = encodeURIComponent(window.location.href);
        document.getElementById('facebookShareBtn').href = `https://www.facebook.com/sharer/sharer.php?u=${pageUrl}`;
        document.getElementById('twitterShareBtn').href  = `https://twitter.com/intent/tweet?url=${pageUrl}&text=Watch ${encodeURIComponent(movie.title)} on The Movie Hub!`;
        document.getElementById('whatsappShareBtn').href = `https://wa.me/?text=Watch ${encodeURIComponent(movie.title)} on The Movie Hub: ${pageUrl}`;

        loadRecommendedMovies(movieId);

    } catch (err) {
        console.error(err);
        document.getElementById('movieTitle').textContent = "Error Loading Movie";
    }
});
</script>

</body>
</html>